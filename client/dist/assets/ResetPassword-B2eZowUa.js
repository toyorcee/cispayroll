import{r as t,j as e}from"./mui-DnFkRXo7.js";import{T as M,a as E,b as L,c as $,d as F,e as I,f as V,g as q}from"./index-DTHPE02k.js";import{b as z,u as H,a as U,L as a,m as c,F as g,c as w,y as d}from"./index-BIXGQKdj.js";import"./react-Csw2ODfV.js";import"./vendor-CzoKn9Tw.js";const f=()=>e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",children:[e.jsx("rect",{width:"512",height:"512",rx:"100",fill:"currentColor",className:"text-green-600"}),e.jsx("path",{d:"M156 256C156 238.327 170.327 224 188 224H324C341.673 224 356 238.327 356 256V352C356 369.673 341.673 384 324 384H188C170.327 384 156 369.673 156 352V256Z",fill:"white"}),e.jsx("path",{d:"M256 128C282.51 128 304 149.49 304 176C304 202.51 282.51 224 256 224C229.49 224 208 202.51 208 176C208 149.49 229.49 128 256 128Z",fill:"white"})]});function _(){const y=z(),m=H(),{resetPassword:b}=U(),[n,j]=t.useState(""),[o,N]=t.useState(""),[u,v]=t.useState(""),[x,h]=t.useState(!1),[i,C]=t.useState(!1),[l,P]=t.useState(!1),[k,p]=t.useState(!0),S=[M,E,L,$,F,I,V,q];t.useEffect(()=>{const r=new URLSearchParams(m.search).get("token");r?(console.log("Token found in URL:",r),j(r),p(!0)):(console.log("No token found in URL"),p(!1))},[m]);const R=async s=>{if(s.preventDefault(),o!==u){d.error("Passwords do not match");return}if(!n){d.error("Reset token is missing");return}h(!0);try{console.log("Submitting reset password with token:",n),await b(n,o),d.success("Password reset successful! Redirecting to sign in...",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),setTimeout(()=>{y("/auth/signin")},2e3)}catch(r){console.error("Reset password error:",r)}finally{h(!1)}};return k?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 via-gray-100 to-gray-200 -z-20",children:S.map((s,r)=>Array.from({length:8}).map((A,T)=>e.jsx(c.div,{initial:{opacity:.1},animate:{opacity:[.2,.4,.2],scale:[1,1.2,1],rotate:[0,360]},transition:{duration:Math.random()*15+10,repeat:1/0,repeatType:"reverse",delay:Math.random()*5},className:"absolute text-gray-400/30",style:{left:`${Math.random()*95}%`,top:`${Math.random()*95}%`,fontSize:`${Math.random()*60+30}px`,transform:`rotate(${Math.random()*360}deg)`,filter:"blur(0.5px)"},children:e.jsx(s,{})},`${r}-${T}`)))}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/50 to-transparent -z-10"}),e.jsxs("div",{className:"w-full max-w-md px-4 bg-white py-5 rounded-xl",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-6",children:[e.jsxs(a,{to:"/",className:"inline-flex justify-center items-center gap-2",children:[e.jsx(f,{}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"PMS"})]}),e.jsx("h2",{className:"mt-4 text-2xl font-bold tracking-tight text-gray-900",children:"Reset Password"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Enter your new password below."})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:e.jsx("div",{className:"bg-white/90 backdrop-blur-xl shadow-2xl rounded-xl p-6",children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"newPassword",name:"newPassword",type:i?"text":"password",autoComplete:"new-password",required:!0,value:o,onChange:s=>N(s.target.value),className:"block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-green-500 focus:outline-none focus:ring-green-500 pr-10",placeholder:"Enter your new password"}),e.jsx("button",{type:"button",onClick:()=>C(!i),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 cursor-pointer",children:i?e.jsx(g,{className:"h-5 w-5"}):e.jsx(w,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:l?"text":"password",autoComplete:"new-password",required:!0,value:u,onChange:s=>v(s.target.value),className:"block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-green-500 focus:outline-none focus:ring-green-500 pr-10",placeholder:"Confirm your new password"}),e.jsx("button",{type:"button",onClick:()=>P(!l),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 cursor-pointer",children:l?e.jsx(g,{className:"h-5 w-5"}):e.jsx(w,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{type:"submit",disabled:x,className:`w-full flex justify-center py-2 px-4 rounded-lg border border-transparent \r
                           !bg-green-600 !text-white font-medium hover:!bg-green-700 \r
                           focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 \r
                           transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer`,children:x?"Resetting...":"Reset Password"})})]})})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",e.jsx(a,{to:"/auth/signin",className:"font-medium text-green-600 hover:text-green-500",children:"Sign in"})]})})]})]}):e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-md px-4 bg-white py-5 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs(a,{to:"/",className:"inline-flex justify-center items-center gap-2",children:[e.jsx(f,{}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"PMS"})]}),e.jsx("h2",{className:"mt-4 text-2xl font-bold tracking-tight text-gray-900",children:"Invalid Reset Link"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"The password reset link is invalid or has expired."})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(a,{to:"/auth/forgot-password",className:"font-medium text-green-600 hover:text-green-500",children:"Request a new password reset link"})})]})})}export{_ as default};
